<UserControl x:Class="Abt.Controls.SciChart.Example.Examples.IWantTo.InspectDatapoints.RolloverFeedback"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Common="clr-namespace:Abt.Controls.SciChart.Example.Common"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:SciChart="http://schemas.abtsoftware.co.uk/scichart"
             d:DesignHeight="300"
             d:DesignWidth="400"
             mc:Ignorable="d">

    <UserControl.Resources>
        <!--  Converter used by feedback panel below SciChartSurface  -->
        <Common:ColorToBrushConverter x:Key="ColorToBrushConverter" />

        <!-- Template for the RolloverModifier tooltip to display SeriesInfo collection (result of hit test)  -->
        <!-- See the members for SeriesInfo to see what you can bind to -->
        <ControlTemplate x:Key="RolloverLabelTemplate" TargetType="SciChart:TemplatableControl">
            <Border Background="#77FFFFFF"
                    BorderBrush="{Binding SeriesColor,
                                          Converter={StaticResource ColorToBrushConverter}}"
                    BorderThickness="2"
                    CornerRadius="5">
                <StackPanel Margin="5">
                    <TextBlock FontSize="12"
                               FontWeight="Bold"
                               Foreground="{Binding SeriesColor,
                                                    Converter={StaticResource ColorToBrushConverter}}"
                               Text="{Binding SeriesName}" />
                    <TextBlock FontSize="11"
                               Foreground="{Binding SeriesColor,
                                                    Converter={StaticResource ColorToBrushConverter}}"
                               Text="{Binding Value}" />
                </StackPanel>
            </Border>
        </ControlTemplate>

        <!-- This DataTemplate binds to each SeriesInfo in the Legend (Top Left of Chart) --> 
        <DataTemplate x:Key="LegendItemTemplate" DataType="SciChart:SeriesInfo">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <!--  Bind to the SeriesName using the SeriesColor as text foreground  -->
                <TextBlock Grid.Column="0"
                                Margin="3,3,20,3"
                                FontSize="13"
                                FontWeight="Bold"
                                Foreground="{Binding SeriesColor, Converter={StaticResource ColorToBrushConverter}}"
                                Text="{Binding SeriesName}" />

                <!--  Bind to the Series Value, using the SeriesColor as text foreground  -->

                <!-- When binding to XValue, YValue of type IComparable, StringFormat is mandatory due to a -->
                <!-- XAML bug that cannot convert IComparable to text, even though underlying type is double -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="3,3,20,3">
                    <TextBlock Foreground="{Binding SeriesColor, Converter={StaticResource ColorToBrushConverter}}" FontSize="13" FontWeight="Bold">
                            <Run Text="X: "/>
                            <Run Text="{Binding XValue, StringFormat=\{0:0.00\}}"/>
                    </TextBlock>
                </StackPanel>
                <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="3,3,20,3">
                    <TextBlock Foreground="{Binding SeriesColor, Converter={StaticResource ColorToBrushConverter}}" FontSize="13" FontWeight="Bold">
                            <Run Text="Y: "/>
                            <Run Text="{Binding YValue, StringFormat=\{0:0.00\}}"/>
                    </TextBlock>
                </StackPanel>

            </Grid>
        </DataTemplate>

    </UserControl.Resources>

    <Grid SciChart:ThemeManager.Theme="Chrome">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <SciChart:SciChartSurface x:Name="sciChartSurface"
                                  Grid.Row="1">

            <!--  Declare Axes  -->
            <SciChart:SciChartSurface.XAxis>
                <SciChart:NumericAxis AutoRange="Always" GrowBy="0.1, 0.1" />
            </SciChart:SciChartSurface.XAxis>

            <SciChart:SciChartSurface.YAxis>
                <SciChart:NumericAxis AutoRange="Always" GrowBy="0.1, 0.1" />
            </SciChart:SciChartSurface.YAxis>

            <!--  Declare RenderableSeries  -->
            <SciChart:SciChartSurface.RenderableSeries>

                <!--  Declare first line series with a PointMarker and RolloverMarker control template  -->
                <SciChart:FastLineRenderableSeries>
                    <SciChart:FastLineRenderableSeries.Style>
                        <Style TargetType="SciChart:FastLineRenderableSeries">
                            <Setter Property="SeriesColor" Value="DarkSlateGray" />
                            <Setter Property="StrokeThickness" Value="2" />
                            <Setter Property="PointMarkerTemplate">
                                <Setter.Value>
                                    <!--  Define an EllipsePointMarker inside a ControlTemplate when styling. x:Name is required  -->
                                    <!--  Alternatively if defining point markers inline you can set a BasePointMarker derived type on the  -->
                                    <!--  BaseRenderableSeries.PointMarker property. See the Point Markers demo for more information  -->
                                    <ControlTemplate>
                                        <SciChart:EllipsePointMarker x:Name="PART_PointMarker"
                                                                     Width="7"
                                                                     Height="7"
                                                                     Fill="Lavender"
                                                                     Stroke="DarkSlateGray" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="RolloverMarkerTemplate">
                                <Setter.Value>
                                    <!--  RolloverMarkers are UIElements, there is only one on the chart at one time and we use the UIElement mouse events for tooltips  -->
                                    <ControlTemplate>
                                        <Ellipse Width="11"
                                                 Height="11"
                                                 Fill="SlateGray"
                                                 Stroke="Lavender"
                                                 StrokeThickness="2" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </SciChart:FastLineRenderableSeries.Style>

                    <SciChart:FastLineRenderableSeries.SelectedSeriesStyle>
                        <Style TargetType="SciChart:FastLineRenderableSeries">
                            <Setter Property="SeriesColor" Value="DarkGreen" />
                            <Setter Property="StrokeThickness" Value="2" />
                            <Setter Property="PointMarkerTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <!--  Define an EllipsePointMarker inside a ControlTemplate when styling. x:Name is required  -->
                                        <!--  Alternatively if defining point markers inline you can set a BasePointMarker derived type on the  -->
                                        <!--  BaseRenderableSeries.PointMarker property. See the Point Markers demo for more information  -->
                                        <SciChart:EllipsePointMarker x:Name="PART_PointMarker"
                                                                     Width="7"
                                                                     Height="7"
                                                                     Fill="Gray"
                                                                     Stroke="DarkGreen" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="RolloverMarkerTemplate">
                                <Setter.Value>
                                    <!--  RolloverMarkers are UIElements, there is only one on the chart at one time and we use the UIElement mouse events for tooltips  -->
                                    <ControlTemplate>
                                        <Ellipse Width="11"
                                                 Height="11"
                                                 Fill="Green"
                                                 Stroke="Lavender"
                                                 StrokeThickness="2" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </SciChart:FastLineRenderableSeries.SelectedSeriesStyle>
                </SciChart:FastLineRenderableSeries>

                <!--  Declare second line series with a PointMarker and RolloverMarker control template  -->
                <SciChart:FastLineRenderableSeries>

                    <SciChart:FastLineRenderableSeries.Style>
                        <Style TargetType="SciChart:FastLineRenderableSeries">
                            <Setter Property="SeriesColor" Value="RosyBrown" />
                            <Setter Property="StrokeThickness" Value="2" />
                            <Setter Property="PointMarkerTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <!--  Define an EllipsePointMarker inside a ControlTemplate when styling. x:Name is required  -->
                                        <!--  Alternatively if defining point markers inline you can set a BasePointMarker derived type on the  -->
                                        <!--  BaseRenderableSeries.PointMarker property. See the Point Markers demo for more information  -->
                                        <SciChart:EllipsePointMarker Width="7"
                                                                     Height="7"
                                                                     Fill="Lavender"
                                                                     Stroke="RosyBrown" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="RolloverMarkerTemplate">
                                <Setter.Value>
                                    <!--  RolloverMarkers are UIElements, there is only one on the chart at one time and we use the UIElement mouse events for tooltips  -->
                                    <ControlTemplate>
                                        <Ellipse Width="11"
                                                 Height="11"
                                                 Fill="RosyBrown"
                                                 Stroke="Lavender"
                                                 StrokeThickness="2" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </SciChart:FastLineRenderableSeries.Style>

                    <SciChart:FastLineRenderableSeries.SelectedSeriesStyle>
                        <Style TargetType="SciChart:FastLineRenderableSeries">
                            <Setter Property="SeriesColor" Value="SaddleBrown" />
                            <Setter Property="StrokeThickness" Value="2" />
                            <Setter Property="PointMarkerTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <!--  Define an EllipsePointMarker inside a ControlTemplate when styling. x:Name is required  -->
                                        <!--  Alternatively if defining point markers inline you can set a BasePointMarker derived type on the  -->
                                        <!--  BaseRenderableSeries.PointMarker property. See the Point Markers demo for more information  -->
                                        <SciChart:EllipsePointMarker Width="7" Height="7" Fill="Gray" Stroke="SaddleBrown" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="RolloverMarkerTemplate">
                                <Setter.Value>
                                    <!--  RolloverMarkers are UIElements, there is only one on the chart at one time and we use the UIElement mouse events for tooltips  -->
                                    <ControlTemplate>
                                        <Ellipse Width="11"
                                                 Height="11"
                                                 Fill="SaddleBrown"
                                                 Stroke="Lavender"
                                                 StrokeThickness="2" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </SciChart:FastLineRenderableSeries.SelectedSeriesStyle>
                </SciChart:FastLineRenderableSeries>

                <SciChart:FastLineRenderableSeries IsVisible="False">
                    <SciChart:FastLineRenderableSeries.Style>
                        <Style TargetType="SciChart:FastLineRenderableSeries">
                            <Setter Property="RolloverMarkerTemplate">
                                <Setter.Value>
                                    <!--  RolloverMarkers are UIElements, there is only one on the chart at one time and we use the UIElement mouse events for tooltips  -->
                                    <ControlTemplate>
                                        <Ellipse Width="11"
                                                 Height="11"
                                                 Fill="DarkViolet"
                                                 Stroke="Lavender"
                                                 StrokeThickness="2" />
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </SciChart:FastLineRenderableSeries.Style>
                </SciChart:FastLineRenderableSeries>
                
            </SciChart:SciChartSurface.RenderableSeries>

            <!--  Declare ChartModifiers  -->
            <SciChart:SciChartSurface.ChartModifier>
                <SciChart:ModifierGroup>
                    <SciChart:LegendModifier ShowLegend="True" LegendData="{Binding SeriesData, ElementName=rolloverModifier}" LegendItemTemplate="{StaticResource LegendItemTemplate}" Margin="10" />
                    <SciChart:RolloverModifier x:Name="rolloverModifier"
                                               DrawVerticalLine="True"
                                               SourceMode="{Binding SelectedValue, ElementName=rolloverModes, Mode=OneWay}"
                                               ShowTooltipOn="{Binding SelectedValue, ElementName=tooltipModes, Mode=OneWay}"
                                               TooltipLabelTemplate="{StaticResource RolloverLabelTemplate}" />
                    <SciChart:SeriesSelectionModifier ReceiveHandledEvents="True" />
                </SciChart:ModifierGroup>
            </SciChart:SciChartSurface.ChartModifier>

        </SciChart:SciChartSurface>

        <StackPanel Orientation="Horizontal">
            <TextBlock Margin="3"
                       VerticalAlignment="Center"
                       Foreground="White"
                       Text="Rollover mode:" />
            <ComboBox x:Name="rolloverModes"
                      Margin="2"
                      VerticalAlignment="Center"
                      SelectedIndex="1"
                      SelectionChanged="OnRolloverModeChanged" />
            <TextBlock Margin="15,3,3,3"
                       VerticalAlignment="Center"
                       Foreground="White"
                       Text="Show tooltip mode:" />
            <ComboBox x:Name="tooltipModes"
                      Margin="2"
                      VerticalAlignment="Center"
                      SelectedIndex="1"
                      SelectionChanged="OnTooltipModeChanged" />
        </StackPanel>
    </Grid>
</UserControl>
