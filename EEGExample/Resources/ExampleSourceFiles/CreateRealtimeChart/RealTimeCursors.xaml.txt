<UserControl x:Class="Abt.Controls.SciChart.Example.Examples.IWantTo.CreateRealtimeChart.RealTimeCursors"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:s="http://schemas.abtsoftware.co.uk/scichart"
             xmlns:Common="clr-namespace:Abt.Controls.SciChart.Example.Common" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">

    <UserControl.Resources>
        <!-- Converter used by feedback panel below SciChartSurface-->
        <Common:ColorToBrushConverter x:Key="ColorToBrushConverter"/>

        <!-- Common TextBlock style, uses ColorToBrushConverter to convert RenderableSeries.SeriesColor to a brush for textblocks -->
        <Style TargetType="TextBlock" x:Key="tbStyle">
            <Setter Property="Margin" Value="2,4"/>
            <Setter Property="Foreground" Value="{Binding SeriesColor, Converter={StaticResource ColorToBrushConverter}}"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="11"/>
        </Style>

        <s:EllipsePointMarker x:Key="pointMarker" Width="6" Height="6" Fill="Yellow"/>

    </UserControl.Resources>

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition />
        </Grid.RowDefinitions>

        <!-- Define a SciChartSurface with RolloverModifier -->
        <s:SciChartSurface x:Name="sciChartSurface" s:ThemeManager.Theme="ExpressionLight" Grid.RowSpan="2" ChartTitle="Mouse-over Cursors in Realtime">

            <s:SciChartSurface.RenderableSeries>
                <s:FastLineRenderableSeries x:Name="renderableSeries0" StrokeThickness="2" SeriesColor="DarkOrange" PointMarker="{StaticResource pointMarker}"/>
                <s:FastLineRenderableSeries x:Name="renderableSeries1" StrokeThickness="2" SeriesColor="SteelBlue" PointMarker="{StaticResource pointMarker}"/>
                <s:FastLineRenderableSeries x:Name="renderableSeries2" StrokeThickness="2" SeriesColor="DarkOliveGreen" PointMarker="{StaticResource pointMarker}"/>
            </s:SciChartSurface.RenderableSeries>

            <s:SciChartSurface.XAxis>
                <s:NumericAxis AutoRange="Always" AxisTitle="Time (Seconds)" TextFormatting="0.0"/>
            </s:SciChartSurface.XAxis>

            <s:SciChartSurface.YAxis>
                <s:NumericAxis AutoRange="Always" AxisTitle="Amplitude (Volts)" TextFormatting="0.00" DrawMajorBands="True" GrowBy="0.1, 0.1"/>
            </s:SciChartSurface.YAxis>

            <s:SciChartSurface.ChartModifier>
                <s:RolloverModifier x:Name="rolloverModifier" ShowAxisLabels="False" UseInterpolation="True" />
            </s:SciChartSurface.ChartModifier>

            <!-- A nice technique is to put the rollover legend inside an annotation with relative coordinates, then it is always inside the chart surface -->
            <s:SciChartSurface.Annotations>
                <s:CustomAnnotation CoordinateMode="Relative" X1="0.01" Y1="0.02" Content="{Binding SeriesData, ElementName=rolloverModifier}" HorizontalAnchorPoint="Left" VerticalAnchorPoint="Top">
                    <s:CustomAnnotation.ContentTemplate>
                        <DataTemplate>
                        <!-- Define a panel to display rollover results -->
                        <Border Grid.Row="1" BorderBrush="#55000000" BorderThickness="2" Background="#77FFFFFF" VerticalAlignment="Top"
                          HorizontalAlignment="Left" Padding="5">
                            <ItemsControl DataContext="{Binding}" ItemsSource="{Binding SeriesInfo}">
                                <ItemsControl.ItemTemplate>
                                    <!-- Template will be instantiated for each SeriesInfo in the RolloverModifier.SeriesInfo collection -->
                                    <!-- See the SciChart API Documentation for SeriesInfo types, there is a different type for OHLC and XyzDataSeries for instance -->
                                    <!-- SeriesInfo is the datacontext for the below. Note you can access the original RenderableSeries via SeriesInfo.RenderableSeries -->
                                    <DataTemplate>
                                        <Grid HorizontalAlignment="Left">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <Ellipse Fill="{Binding SeriesColor, Converter={StaticResource ColorToBrushConverter}}" Width="9" Height="9" Margin="3"/>

                                            <TextBlock Grid.Column="1" Text="{Binding SeriesName}" Width="90" Style="{StaticResource tbStyle}"/>

                                            <!-- When binding to XValue, YValue of type IComparable, StringFormat is mandatory due to a -->
                                            <!-- XAML bug that cannot convert IComparable to text, even though underlying type is double -->
                                            <StackPanel Orientation="Horizontal" Grid.Column="2">
                                                <TextBlock Text="X: " Style="{StaticResource tbStyle}"/>
                                                <TextBlock Text="{Binding XValue, StringFormat=\{0:0.00\}}" Style="{StaticResource tbStyle}"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Grid.Column="3">
                                                <TextBlock Text="Y: " Margin="3" Style="{StaticResource tbStyle}" />
                                                <TextBlock Text="{Binding YValue, StringFormat=\{0:0.00\}}" Style="{StaticResource tbStyle}"/>
                                            </StackPanel>

                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </Border>
                        </DataTemplate>
                    </s:CustomAnnotation.ContentTemplate>
                </s:CustomAnnotation>
            </s:SciChartSurface.Annotations>
        </s:SciChartSurface>

        <!--  IGNORE BELOW HERE: Toolbar  -->
        <StackPanel Orientation="Horizontal">

            <!-- Sets a flag on how RolloverModifier should behave. If true, uses interpolation between points, else snaps to points -->
            <CheckBox x:Name="useInterpolation" Content="Use RolloverModifier interpolation?" 
                      IsChecked="{Binding UseInterpolation, ElementName=rolloverModifier, Mode=TwoWay}" 
                      Foreground="#333" Margin="5,3" VerticalAlignment="Center"/>
        </StackPanel>

    </Grid>

</UserControl>
