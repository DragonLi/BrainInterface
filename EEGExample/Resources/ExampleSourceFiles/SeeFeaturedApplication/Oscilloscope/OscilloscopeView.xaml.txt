<UserControl x:Class="Abt.Controls.SciChart.Example.Examples.IWantTo.SeeFeaturedApplication.Oscilloscope.OscilloscopeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:Common="clr-namespace:Abt.Controls.SciChart.Example.Common"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:examples="clr-namespace:Abt.Controls.SciChart.Example.Examples.IWantTo.SeeFeaturedApplication.Oscilloscope"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:s="http://schemas.abtsoftware.co.uk/scichart"
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             d:DesignHeight="768"
             d:DesignWidth="1024"
             mc:Ignorable="d">

    <UserControl.Resources>

        <Common:VisibleIfTypeConverter x:Key="VisibleIfTypeConverter" />
        <Common:IsModifierTypeConverter x:Key="IsModifierTypeConverter" />

        <Style x:Key="TextBlockStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontFamily" Value="Arial" />
            <Setter Property="FontSize" Value="10" />
            <Setter Property="Margin" Value="3,2,2,2" />
        </Style>

        <Style x:Key="HintDataItemsStyle"
               BasedOn="{StaticResource TextBlockStyle}"
               TargetType="TextBlock">
            <Setter Property="FontSize" Value="13" />
        </Style>

        <Style x:Key="ChartDataItemsStyle"
               BasedOn="{StaticResource TextBlockStyle}"
               TargetType="TextBlock">
            <Setter Property="Foreground" Value="#FF93F2C1" />
        </Style>

        <!--  Set the style for the series  -->
        <Style x:Key="LineSeriesStyle" TargetType="s:FastLineRenderableSeries">
            <Setter Property="StrokeThickness" Value="2" />
            <Setter Property="AntiAliasing" Value="True" />
            <Setter Property="SeriesColor" Value="#FFA3FFC9" />
            <Setter Property="RolloverMarkerTemplate">
                <Setter.Value>
                    <ControlTemplate>
                        <Ellipse Width="9"
                                 Height="9"
                                 Fill="#7793F2C1"
                                 Stroke="#FFA3FFC9"
                                 StrokeThickness="2" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <DataTemplate x:Key="ChartDataTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Margin="3,2,2,2"
                           Style="{StaticResource ChartDataItemsStyle}"
                           Text="{Binding SeriesName}" />
                <TextBlock Grid.Column="1"
                           Margin="0,2,2,2"
                           Style="{StaticResource ChartDataItemsStyle}"
                           Text=":" />
                <TextBlock Grid.Column="2"
                           Margin="3,2,20,2"
                           Style="{StaticResource ChartDataItemsStyle}"
                           Text="{Binding Value,
                                          StringFormat=\{0:0.0000\}}" />
            </Grid>
        </DataTemplate>

        <!--  Template for the CursorModifier tooltip to display AxisInfo collection (result of hit test)  -->
        <ControlTemplate x:Key="CursorAxisLabelTemplate" TargetType="s:TemplatableControl">
            <Border Background="#33FFFFFF"
                    BorderBrush="#FFFFFFFF"
                    BorderThickness="1"
                    CornerRadius="5">
                  <TextBlock Style="{StaticResource HintDataItemsStyle}" Text="{Binding AxisFormattedDataValue}" />
            </Border>
        </ControlTemplate>

        <!--  Template for the RolloverModifier tooltip to display AxisInfo collection (result of hit test)  -->
        <ControlTemplate x:Key="RolloverLabelTemplate" TargetType="s:TemplatableControl">
            <Border Background="#33FFFFFF"
                    BorderBrush="#FFFFFFFF"
                    BorderThickness="1"
                    CornerRadius="5">
                <StackPanel>
                    <TextBlock Style="{StaticResource HintDataItemsStyle}" Text="{Binding SeriesName}" />
                    <TextBlock Style="{StaticResource HintDataItemsStyle}" Text="{Binding Value}" />
                </StackPanel>
            </Border>
        </ControlTemplate>

    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Define the Toolbar  -->
        <StackPanel Grid.Row="0"
                    Margin="2,4"
                    Orientation="Horizontal">

            <TextBlock Margin="3,8"
                       Foreground="#FFF"
                       Text="Data Source:" />

            <ComboBox MinWidth="100"
                      Margin="3,8"
                      SelectedItem="{Binding SelectedDataSource,
                                             Mode=TwoWay}">
                <ComboBox.Items>
                    <system:String>Fourier Series</system:String>
                    <system:String>Lissajous</system:String>
                </ComboBox.Items>
            </ComboBox>

            <Line Margin="5"
                  Stroke="Gray"
                  Y2="16" />

            <ToggleButton Command="{Binding SetZoomPanModifierCommand}"
                          s:ToggleButtonExtensions.GroupName="Modifiers"
                          Style="{StaticResource exampleToolbarToggleButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <Image Margin="3"
                           Source="/Abt.Controls.SciChart.Example;component/Resources/Images/cursor_drag_arrow_2.png"
                           Stretch="None" />
                    <TextBlock Margin="3" Text="Pan" />
                </StackPanel>
            </ToggleButton>
            <ToggleButton Command="{Binding SetRubberBandZoomModifierCommand}"
                          s:ToggleButtonExtensions.GroupName="Modifiers"
                          Style="{StaticResource exampleToolbarToggleButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <Image Margin="3"
                           Source="/Abt.Controls.SciChart.Example;component/Resources/Images/zoom.png"
                           Stretch="None" />
                    <TextBlock Margin="3" Text="Zoom" />
                </StackPanel>
            </ToggleButton>
            <ToggleButton Command="{Binding SetRolloverModifierCommand}"
                          IsChecked="{Binding IsRolloverSelected,
                                              Mode=OneWay}"
                          IsEnabled="{Binding CanExecuteRollover}"
                          s:ToggleButtonExtensions.GroupName="Modifiers"
                          Style="{StaticResource exampleToolbarToggleButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <Image Margin="3"
                           Source="/Abt.Controls.SciChart.Example;component/Resources/Images/chart_line_2.png"
                           Stretch="None" />
                    <TextBlock Margin="3" Text="Rollover" />
                </StackPanel>
            </ToggleButton>
            <ToggleButton Command="{Binding SetCursorModifierCommand}"
                          IsChecked="{Binding IsCursorSelected,
                                              Mode=OneWay}"
                          s:ToggleButtonExtensions.GroupName="Modifiers"
                          Style="{StaticResource exampleToolbarToggleButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <Image Margin="3"
                           Source="/Abt.Controls.SciChart.Example;component/Resources/Images/target.png"
                           Stretch="None" />
                    <TextBlock Margin="3" Text="Cursor" />
                </StackPanel>
            </ToggleButton>
            <Line Margin="5"
                  Stroke="Gray"
                  Y2="16" />

            <ToggleButton Width="95"
                          Command="{Binding SetDigitalLineCommand}"
                          IsChecked="{Binding IsDigitalLine,
                                              Mode=OneWay}"
                          Style="{StaticResource exampleToolbarToggleButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <Image Margin="3"
                           Source="/Abt.Controls.SciChart.Example;component/Resources/Images/step_line.png"
                           Stretch="None" />
                    <TextBlock Margin="3" Text="Is Step Line" />
                </StackPanel>
            </ToggleButton>
            <Button Command="{Binding ResetZoomCommand}" Style="{StaticResource exampleToolbarButtonStyle}">
                <StackPanel Orientation="Horizontal">
                    <Image Margin="3"
                           Source="/Abt.Controls.SciChart.Example;component/Resources/Images/fit_to_size.png"
                           Stretch="None" />
                    <TextBlock Margin="3" Text="Zoom Extents" />
                </StackPanel>
            </Button>
        </StackPanel>

        <s:SciChartSurface x:Name="oscilloscopeChart"
                           Grid.Row="1"
                           Grid.RowSpan="2"
                           RenderPriority="Low"
                           s:ThemeManager.Theme="Oscilloscope">

            <!--  Declare RenderableSeries, which map 1:1 to DataSet series and in order  -->
            <s:SciChartSurface.RenderableSeries>
                <s:FastLineRenderableSeries DataSeries="{Binding ChartData}"
                                            IsDigitalLine="{Binding IsDigitalLine, Mode=TwoWay}"
                                            ResamplingMode="{Binding SeriesResamplingMode}"
                                            Style="{StaticResource LineSeriesStyle}" />
            </s:SciChartSurface.RenderableSeries>

            <!--  Create default X and Y axes. Optional bands give a cool look and feel for minimal performance impact  -->
            <s:SciChartSurface.XAxis>
                <s:NumericAxis AnimatedVisibleRange="{Binding XVisibleRange,
                                                              Mode=TwoWay}"
                               VisibleRangeLimit="{Binding XLimit}"
                               AxisTitle="Time (ms)"
                               DrawMajorBands="True"
                               TextFormatting="0.00" />
            </s:SciChartSurface.XAxis>

            <s:SciChartSurface.YAxis>
                <s:NumericAxis AnimatedVisibleRange="{Binding YVisibleRange,
                                                              Mode=TwoWay}"
                               VisibleRangeLimit="{Binding YLimit}"
                               AxisTitle="Voltage (mV)"
                               GrowBy="0.1, 0.1"
                               TextFormatting="0.00" />
            </s:SciChartSurface.YAxis>

            <!--  Create ChartModifiers, which are enabled or disabled from the ViewModel via the ChartModifier property and IsModifierTypeConverter  -->
            <s:SciChartSurface.ChartModifier>
                <s:ModifierGroup>
                    <s:XAxisDragModifier />
                    <s:YAxisDragModifier />
                    <s:RolloverModifier IsEnabled="{Binding ChartModifier, Mode=TwoWay, Converter={StaticResource IsModifierTypeConverter}, ConverterParameter=Rollover}" TooltipLabelTemplate="{StaticResource RolloverLabelTemplate}" />
                    <s:ZoomPanModifier IsEnabled="{Binding ChartModifier, Mode=TwoWay, Converter={StaticResource IsModifierTypeConverter}, ConverterParameter=ZoomPan}" />
                    <s:CursorModifier AxisLabelTemplate="{StaticResource CursorAxisLabelTemplate}" IsEnabled="{Binding ChartModifier, Mode=TwoWay, Converter={StaticResource IsModifierTypeConverter}, ConverterParameter=CrosshairsCursor}" />
                    <s:RubberBandXyZoomModifier IsEnabled="{Binding ChartModifier, Mode=TwoWay, Converter={StaticResource IsModifierTypeConverter}, ConverterParameter=RubberBandZoom}" IsXAxisOnly="False" />
                    <s:MouseWheelZoomModifier />
                    <s:ZoomExtentsModifier/>
                </s:ModifierGroup>
            </s:SciChartSurface.ChartModifier>

        </s:SciChartSurface>

        <!--  Define the overlay panel to show start and to dates, chart values  -->
        <Grid Grid.Row="1"
              Grid.RowSpan="2"
              Margin="35,35,15,0"
              DataContext="{Binding ElementName=oscilloscopeChart,
                                    Path=ChartModifier[RolloverModifier]}"
              Visibility="{Binding ElementName=oscilloscopeChart,
                                   Path=DataContext.ChartModifier,
                                   Converter={StaticResource VisibleIfTypeConverter},
                                   ConverterParameter=Rollover}">
            <ItemsControl MinHeight="24"
                          VerticalAlignment="Top"
                          ItemsSource="{Binding SeriesData.SeriesInfo}"
                          ItemTemplate="{StaticResource ChartDataTemplate}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
            </ItemsControl>
        </Grid>

    </Grid>
</UserControl>
